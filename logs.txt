[2025-07-02T12:02:43,463][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:02:43,469][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:02:43,470][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-7552894117349282970, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:02:43,902][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:02:47,430][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:02:47,430][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:02:48,976][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:02:53,124][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:02:53,126][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:02:53,126][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-3168267690199904525, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:02:53,240][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:02:53,858][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:02:53,859][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:02:54,055][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:03:04,621][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:03:04,623][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:03:04,623][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-2211807752282516356, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:03:04,751][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:03:05,397][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:03:05,397][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:03:05,583][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:03:18,342][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:03:18,346][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:03:18,347][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-17935985132776850664, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:03:18,496][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:03:19,085][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:03:19,085][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:03:19,280][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:03:28,758][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:03:28,760][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:03:28,760][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-17592624278052636507, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:03:28,889][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:03:29,532][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:03:29,532][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:03:29,726][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:03:37,370][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:03:37,372][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:03:37,372][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-10053283559256447009, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:03:37,488][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:03:38,129][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:03:38,129][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:03:38,327][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:03:45,273][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:03:45,379][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:03:45,380][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-12416155948477453736, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:03:45,489][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:03:46,095][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:03:46,096][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:03:46,285][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:03:55,837][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:03:55,839][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:03:55,839][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-18032896582992562716, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:03:55,969][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:03:56,559][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:03:56,559][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:03:56,761][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:04:12,492][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:04:12,493][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:04:12,494][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-11418384499063290841, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:04:12,616][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:04:13,205][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:04:13,206][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:04:13,394][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:04:41,887][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:04:41,889][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:04:41,889][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-3332616956246070146, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:04:42,008][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:04:42,619][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:04:42,619][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:04:42,800][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:05:36,786][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:05:36,788][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:05:36,788][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-7514364880975757744, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:05:36,903][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:05:37,505][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:05:37,505][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:05:37,696][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:06:41,878][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:06:41,880][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:06:41,880][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-11839314538719247211, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:06:41,996][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:06:42,607][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:06:42,607][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:06:42,792][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
[2025-07-02T12:07:46,011][INFO ][o.o.n.Node               ] [node-1] version[2.19.1], pid[1], build[rpm/dae2bfc93896178873b43cdf4781f183c72b238f/2025-04-30T10:49:16.411257895Z], OS[Linux/6.12.33+kali-amd64/amd64], JVM[Eclipse Adoptium/OpenJDK 64-Bit Server VM/21.0.6/21.0.6+7-LTS]
[2025-07-02T12:07:46,013][INFO ][o.o.n.Node               ] [node-1] JVM home [/usr/share/wazuh-indexer/jdk], using bundled JDK/JRE [true]
[2025-07-02T12:07:46,013][INFO ][o.o.n.Node               ] [node-1] JVM arguments [-Xshare:auto, -Dopensearch.networkaddress.cache.ttl=60, -Dopensearch.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.security.manager=allow, -Djava.locale.providers=SPI,COMPAT, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/tmp/opensearch-1760054549728121028, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=/var/lib/wazuh-indexer, -XX:ErrorFile=/var/log/wazuh-indexer/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/wazuh-indexer/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.security.manager=allow, -Djava.util.concurrent.ForkJoinPool.common.threadFactory=org.opensearch.secure_sm.SecuredForkJoinWorkerThreadFactory, -Dclk.tck=100, -Djdk.attach.allowAttachSelf=true, -Djava.security.policy=file:///usr/share/wazuh-indexer/opensearch-performance-analyzer/opensearch_security.policy, --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED, -Xms1g, -Xmx1g, -XX:MaxDirectMemorySize=536870912, -Dopensearch.path.home=/usr/share/wazuh-indexer, -Dopensearch.path.conf=/usr/share/wazuh-indexer, -Dopensearch.distribution.type=rpm, -Dopensearch.bundled_jdk=true]
[2025-07-02T12:07:46,131][WARN ][o.a.l.i.v.VectorizationProvider] [node-1] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.
[2025-07-02T12:07:46,800][INFO ][o.o.s.s.t.SSLConfig      ] [node-1] SSL dual mode is disabled
[2025-07-02T12:07:46,800][INFO ][o.o.s.OpenSearchSecurityPlugin] [node-1] OpenSearch Config path is /usr/share/wazuh-indexer
[2025-07-02T12:07:46,996][ERROR][o.o.b.OpenSearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.opensearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:185) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.execute(OpenSearch.java:172) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:104) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.mainWithoutErrorHandling(Command.java:138) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.cli.Command.main(Command.java:101) ~[opensearch-cli-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:138) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.main(OpenSearch.java:104) ~[opensearch-2.19.1.jar:2.19.1]
Caused by: java.lang.IllegalStateException: failed to load plugin class [org.opensearch.security.OpenSearchSecurityPlugin]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:818) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:74) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
Caused by: java.security.AccessControlException: access denied ("java.io.FilePermission" "/etc/wazuh-indexer/certs/root-ca.pem" "read")
	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:488) ~[?:?]
	at java.base/java.security.AccessController.checkPermission(AccessController.java:1071) ~[?:?]
	at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:411) ~[?:?]
	at java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:742) ~[?:?]
	at java.base/sun.nio.fs.UnixPath.checkRead(UnixPath.java:789) ~[?:?]
	at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171) ~[?:?]
	at java.base/sun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99) ~[?:?]
	at java.base/java.nio.file.spi.FileSystemProvider.readAttributesIfExists(FileSystemProvider.java:1270) ~[?:?]
	at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributesIfExists(UnixFileSystemProvider.java:191) ~[?:?]
	at java.base/java.nio.file.Files.isDirectory(Files.java:2320) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.resolvePath(SslCertificatesLoader.java:166) ~[?:?]
	at org.opensearch.security.ssl.config.SslCertificatesLoader.loadConfiguration(SslCertificatesLoader.java:90) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.loadConfigurations(SslSettingsManager.java:145) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.buildSslContexts(SslSettingsManager.java:101) ~[?:?]
	at org.opensearch.security.ssl.SslSettingsManager.<init>(SslSettingsManager.java:88) ~[?:?]
	at org.opensearch.security.ssl.OpenSearchSecuritySSLPlugin.<init>(OpenSearchSecuritySSLPlugin.java:249) ~[?:?]
	at org.opensearch.security.OpenSearchSecurityPlugin.<init>(OpenSearchSecurityPlugin.java:326) ~[?:?]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:502) ~[?:?]
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:486) ~[?:?]
	at org.opensearch.plugins.PluginsService.loadPlugin(PluginsService.java:809) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundle(PluginsService.java:757) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.loadBundles(PluginsService.java:551) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.plugins.PluginsService.<init>(PluginsService.java:197) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:524) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.node.Node.<init>(Node.java:451) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.setup(Bootstrap.java:242) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.Bootstrap.init(Bootstrap.java:404) ~[opensearch-2.19.1.jar:2.19.1]
	at org.opensearch.bootstrap.OpenSearch.init(OpenSearch.java:181) ~[opensearch-2.19.1.jar:2.19.1]
	... 6 more
